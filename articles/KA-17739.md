---
title: "Tracking workflow logic"
description: Description
solution: Campaign,Campaign Classic v7,Campaign v8
product: Campaign,Campaign Classic v7,Campaign v8
applies-to: "Campaign Classic,Campaign,Campaign Classic v7,Campaign v8"
keywords: "KCS,Tracking workflow logic"
resolution: Resolution
internal-notes: 
bug: False
article-created-by: Ananya Kuthiala
article-created-date: "5/10/2022 1:38:14 PM"
article-published-by: Ananya Kuthiala
article-published-date: "5/10/2022 1:38:54 PM"
version-number: 2
article-number: KA-17739
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=b1655370-66d0-ec11-a7b5-0022480a8e40"

---
# Tracking workflow logic

## Description


The tracking workflow show only 1 command without much explanation: <b>tracking -instance:%= instanceName % -download -update</b>



The purpose of this KB article is to list the steps of the workflow in the backend:

<b>Step 1</b> - download and insert tracking logs in the database (NmsTrackingLogXXX). During the -download step the workflow will log nothing.

-download will only fetch the tracking log from the different tracking containers and store them in database.

<b>Step 2</b> - create tracking log statistics (NmsTrackingStats).

-update will consolidate the logs by creating aggregate records in NmsTrackingStats. The entire table is updated based on the deliveries that are marked for update. All tracking reports are fetching data from this table. You can do this step manually for each delivery that is missing Tracking statistics by clicking "recompute delivery statistics".

<b>Step 3</b> final one - rebuild the delivery statistics (NmsDeliveryLogStats) for all delivery impacted by an open or click (deliverers are processed one by one...)

The tracking workflow will also update several other tables:

NmsUserAgentReject 
 NmsDelivery 
 NmsUserAgent 
 NmsTrackingLogRcp 
 NmsTrackingStats

It is important to check the fragmentation rate of indexes in these tables. <u>If index fragmentation is above 30-35% the index needs to be rebuilt.</u> For hosted clients, Adobe performs this maintenance operation once a month. If indexes of the tables are not rebuilt regularly, the tracking workflow execution is slowed down.

<b>To see the exact queries executed by the tracking workflow use the command:</b>

*nlserver tracking -instance:instanceName -download -update -verbose -tracefilter:\<b>

This command will create an additional log inside </b>/var/instanceName/log/tracking.log <b>with all queries executed during Tracking workflow execution.

Sometimes customers ask if they can skip the update process? The answer is NO: Tracking Statistics will not be updated, data will be invalid, which can lead to numerous other problems regarding Tracking which we would like to avoid by any means necessary.

Once the tracking workflow execution is finished, the option </b>NmsTracking_Pointer <b>is updated. The option value will show the date of the last log retrieved in all tracking server containers and the message id in decimal format. If we convert this id to hexadecimal, it will be the name of the tracking file stored on the tracking server.


## Resolution


This article explains the workflow logic so it doesn't require a resolution.
